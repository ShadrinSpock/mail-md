# Техническая документация для ПО генерации писем и ведения журнала корреспонденции

## Оглавление

1. [Общее описание](#общие-описание)
2. [Требования](#требования)
3. [Архитектура системы](#архитектура-системы)
4. [Описание функциональности](#описание-функциональности)
    - [Создание и отправка письма](#создание-и-отправка-письма)
    - [Буферная таблица](#буферная-таблица)
    - [Журнал Корреспонденции](#журнал-корреспонденции)
    - [Хранилище](#хранилище)
5. [Права доступа](#права-доступа)
6. [Многопоточность и обработка данных](#многопоточность-и-обработка-данных)
7. [Автоматическая нумерация](#автоматическая-нумерация)
8. [Примеры использования](#примеры-использования)

## Общее описание

Программное обеспечение (ПО) предназначено для автоматизации процесса генерации, отправки и учета писем в компании. Оно написано на Google Apps Script и использует Google Документы, Google Таблицы и Google Диск для работы. Система позволяет обычным пользователям создавать и скачивать письма, отправлять данные в журнал корреспонденции. Привелигированным пользователям система позволяет редактировать автоматизированный журнал корреспонденции и управлять письмами в хранилище.

## Требования

- Аккаунт Google для каждого пользователя.
- Получение пользователем доступа к документу для отправки писем.
- Предоставление разрешений для выполнения скриптов Google Apps Script.

## Архитектура системы

Система состоит из следующих компонентов:

1. **Google Документы**: Документы, назначенные пользователям, для создания и отправки писем.
2. **Буферная таблица**: Временное хранилище данных о письмах перед их переносом в Журнал Корреспонденции.
3. **Журнал Корреспонденции**: Основной документ для учета входящих и исходящих писем.
4. **Хранилище**: Папка на Google Диске для хранения всех сгенерированных писем в формате PDF.

## Описание функциональности

### Создание и отправка письма

1. **Создание письма**:
   - Пользователь открывает назначенный ему Google Документ.
   - Формирует текст письма, форматирует и изменяет документ.

2. **Отправка письма**:
   - Пользователь выбирает пункт "Меню" -> "Отправить исходящее".
   - При первой отправке необходимо предоставить разрешения для выполнения скрипта.
   - После предоставления разрешений еще раз выбрать "Меню" -> "Отправить исходящее".
   - Появляется окно с полями для заполнения: Дата, Отправитель, Кому, Содержание.
   - Пользователь заполняет поля и нажимает кнопку "Отправить".

3. **Обработка письма**:
   - Скрипт присваивает письму уникальный номер.
   - Записывает данные письма в буферную таблицу.
   - Конвертирует документ в формат PDF, присваивает название с соответсвующим номером и сохраняет его в хранилище на Google Диске.
   - Предоставляет пользователю возможность скачать письмо на свой компьютер в формате PDF.

### Буферная таблица

- Буферная таблица служит временным хранилищем для данных о письмах.
- После получения новых данных скрипт автоматически переносит их в Журнал Корреспонденции.
- После переноса данные удаляются из буферной таблицы.

### Журнал Корреспонденции

- Журнал Корреспонденции автоматически ведет учет данных о входящих и исходящих письмах.
- В дополнительном пункте "Меню" есть кнопка "Удалить письма".
  - Пользователь выбирает тип писем из выпадающего списка
  - Вводит номера писем через пробел.
  - Нажимает кнопку "Удалить", после чего письма удаляются из Журнала и хранилища на Google Диске.

### Хранилище

- Хранилище находится на Google Диске и хранит все сгенерированные пользователями письма в формате PDF.
- Доступ к хранилищу имеют только привилегированные пользователи.

## Права доступа

- **Привилегированные пользователи**: Имеют полный доступ к Журналу Корреспонденции и хранилищу на Google Диске.
- **Обычные пользователи**: Имеют доступ только к назначенным им личным документам.

## Многопоточность и обработка данных

Система поддерживает многопоточность, что позволяет всем пользователям работать одновременно. Даже при одновременной отправке писем всеми пользователями система способна корректно обработать всю информацию благодаря использованию буферной таблицы и автоматическому переносу данных в Журнал Корреспонденции.

## Автоматическая нумерация

При формировании письма скрипт, используя буферную таблицу, автоматически назначает номер сгенерированному письму. Это позволяет пользователю не обращаться за назначением номера к его письму, таким образом обеспечивая экономию времени на лишних коммуникациях. Назначенный письму номер будет использован при переносе данных в Журнал Корреспонденции и отобразится в названии файла PDF, а также в тексте самого письма, путём замены ключевого слова "<number>" на номер. После геренерации письма номер обратно заменится на ключевое слово, для будущей замены на номер следующего письма.

## Примеры использования

### Пример 1: Создание и отправка письма

1. Пользователь открывает личный Google Документ и формирует письмо.

2. Пользователь выбирает "Меню" -> "Отправить исходящее", заполняет поля и нажимает "Отправить".

3. В появившемся окне скачивания пользователь нажимает "Скачать", после чего письмо в формате PDF скачивается на его компьютер.

4. Данные о письме автоматически заносятся в Журнал Корреспондекции.

5. Письмо сохраняется в хранилище в формате PDF с именем "Исходящее письмо №*назначенный номер*.pdf" 

### Пример 2: Удаление писем из Журнала Корреспонденции

1. Привилегированный пользователь открывает Журнал Корреспонденции и выбирает "Меню" -> "Удалить письма".
2. Выбирает тип писем (например, "Исходящие") и вводит номера писем через пробел (например, "1111 1112").
3. Нажимает кнопку "Удалить", после чего указанные письма удаляются из Журнала и хранилища на Google Диске.
