# Техническая документация для ПО генерации писем и ведения журнала корреспонденции

## Оглавление

1. [Общее описание](#общие-описание)
2. [Требования](#требования)
3. [Архитектура системы](#архитектура-системы)
4. [Описание функциональности](#описание-функциональности)
    - [Создание и отправка письма](#создание-и-отправка-письма)
    - [Буферная таблица](#буферная-таблица)
    - [Журнал Корреспонденции](#журнал-корреспонденции)
    - [Хранилище](#хранилище)
5. [Права доступа](#права-доступа)
6. [Многопоточность и обработка данных](#многопоточность-и-обработка-данных)
7. [Примеры использования](#примеры-использования)

## Общее описание

Программное обеспечение (ПО) предназначено для автоматизации процесса генерации, отправки и учета писем в компании. Оно написано на Google Apps Script и использует Google Документы, Google Таблицы и Google Диск для работы. Система позволяет пользователям создавать письма, отправлять их, сохранять в формате PDF на Google Диск и вести журнал корреспонденции.

## Требования

- Аккаунт Google для каждого пользователя.
- Доступ к Google Документам, Google Таблицам и Google Диску.
- Предоставление разрешений для выполнения скриптов Google Apps Script.

## Архитектура системы

Система состоит из следующих компонентов:

1. **Google Документы**: Личные документы пользователей для создания писем.
2. **Буферная таблица**: Временное хранилище данных о письмах перед их переносом в Журнал Корреспонденции.
3. **Журнал Корреспонденции**: Основной документ для учета входящих и исходящих писем.
4. **Хранилище**: Папка на Google Диске для хранения всех сгенерированных писем в формате PDF.

## Описание функциональности

### Создание и отправка письма

1. **Создание письма**:
   - Пользователь открывает личный Google Документ.
   - Формирует текст письма, используя шаблон с ключевым словом <number> для номера письма.

2. **Отправка письма**:
   - Пользователь выбирает пункт "Меню" -> "Отправить исходящее".
   - При первой отправке необходимо предоставить разрешения для выполнения скрипта.
   - После предоставления разрешений еще раз выбрать "Меню" -> "Отправить исходящее".
   - Появляется окно с полями для заполнения: Дата, Отправитель, Кому, Содержание.
   - Пользователь заполняет поля и нажимает кнопку "Отправить".

3. **Обработка письма**:
   - Скрипт присваивает письму уникальный номер.
   - Заменяет ключевое слово <number> на этот номер в тексте письма.
   - Записывает данные письма в буферную таблицу.
   - Конвертирует документ в формат PDF и сохраняет его в хранилище на Google Диске.
   - Предоставляет пользователю возможность скачать PDF файл.

### Буферная таблица

- Буферная таблица служит временным хранилищем для данных о письмах.
- После получения новых данных скрипт автоматически переносит их в Журнал Корреспонденции.
- После переноса данные удаляются из буферной таблицы.

### Журнал Корреспонденции

- Журнал Корреспонденции автоматически ведет учет данных о входящих и исходящих письмах.
- В дополнительном меню журнала есть кнопка "Удалить письма".
  - Пользователь выбирает тип писем из выпадающего списка и вводит номера писем через пробел.
  - Нажимает кнопку "Удалить", после чего письма удаляются из Журнала и хранилища на Google Диске.

### Хранилище

- Хранилище находится на Google Диске и хранит все сгенерированные пользователями письма в формате PDF.
- Доступ к хранилищу имеют только директора компании и разработчики.

## Права доступа

- **Директора и разработчики**: Имеют полный доступ к Журналу Корреспонденции и хранилищу на Google Диске.
- **Обычные пользователи**: Имеют доступ только к назначенным им личным документам и скрытый доступ к буферной таблице.

## Многопоточность и обработка данных

Система поддерживает многопоточность, что позволяет всем пользователям работать одновременно. Даже при одновременной отправке писем всеми пользователями система способна корректно обработать всю информацию благодаря использованию буферной таблицы и автоматическому переносу данных в Журнал Корреспонденции.

## Примеры использования

### Пример 1: Создание и отправка письма

1. Пользователь открывает личный Google Документ и формирует письмо:
      Уважаемый <Кому>,
   
   Сообщаем вам, что номер вашего запроса: <number>.
   
   С уважением,
   <Отправитель>
   

2. Пользователь выбирает "Меню" -> "Отправить исходящее", заполняет поля и нажимает "Отправить".

3. Письмо сохраняется в формате PDF с именем "Исходящее письмо №1111.pdf" на Google Диске и становится доступным для скачивания.

### Пример 2: Удаление писем из Журнала Корреспонденции

1. Директор открывает Журнал Корреспонденции и выбирает "Меню" -> "Удалить письма".
2. Выбирает тип писем (например, "Исходящие") и вводит номера писем через пробел (например, "1111 1112").
3. Нажимает кнопку "Удалить", после чего указанные письма удаляются из Журнала и хранилища на Google Диске.

Эта документация предоставляет полное руководство по использованию ПО для генерации писем и ведения журнала корреспонденции, а также описывает архитектуру системы, права доступа и примеры использования.
